<!doctype html>
<head>
  <meta charset="utf-8">

  <title>课程填补信息</title>
  <meta name="description" content="My Bmob App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="jquery.min.js"></script>
  <script type="text/javascript" src="bmob.js"></script>
</head>

<body>
  <div id="copy" data-clipboard-text="NVJiQ16834">
    <h1 style="text-align:center;font-size:30px"><font face="verdana">请在淘宝购买后填补以下信息</font></h1>
    <p style="text-align:center;font-size:30px"><br> 
      <form name="myform">
      <h2 style="text-align:center;font-size:15px"><font face="verdana">学生姓名</font></h2>  
       <input type="text" name="name" id="nn" /><br>
       <h2 style="text-align:center;font-size:15px"><font face="verdana">淘宝验证码</font></h2>  
       <input type="text" name="code" id="mm" /><br>
       <input type="button" name="button" value="提交" onclick="print()" />  
      </form>
    </p>
  </div>   
  
  <script src="https://cdnjs.cat.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cat.net/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>
  <script src="bmob-min.js"></script>
  <script src="javascripts/bmobSocketIo.js"></script>
  <script type="text/javascript">

    Bmob.initialize("3f38aebe7d4ee56a45b58e2ecd3b197b", "15c728de9831a0a1e98b10fc1a31c06c");
    BmobSocketIo.initialize("3f38aebe7d4ee56a45b58e2ecd3b197b");
	
  function copycode()
      {
          if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
          {
              var clipboard = new Clipboard('#copy');

              clipboard.on('success', function (e)
              {
              });
              clipboard.on('error', function (e)
              {
              });
          }
      }

  function print(){
    var a=myform.name.value;
    var b=myform.code.value;
    if (a.length == 0 || b.length == 0){ 
        alert("请输入学生姓名和验证码");
    }else{
      var GameScore = Bmob.Object.extend("GameScore");
      var gameScore = new GameScore();
     gameScore.save({name: a, captcha: b}, {
      success: function(object) {
        $(".success").show();
      },
      error: function(model, error) {
        $(".error").show();
      }
    });
      $("body").onclick = copycode();
      }
    }
     //初始连接socket.io服务器后，需要监听的事件都写在这个函数内
    BmobSocketIo.onInitListen = function() {
     //订阅GameScore表的数据更新事件
      BmobSocketIo.updateTable("GameScore");     
    };  
    //监听服务器返回的更新表的数据
   BmobSocketIo.onUpdateTable = function(tablename,data) {   
     if( tablename=="GameScore" ) {
       alert("您已成功提交，关闭此对话框后，请点击左上角返回");
     }
   };
  </script>
</body>
</html>
